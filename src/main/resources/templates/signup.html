<!DOCTYPE html>
<html
  xmlns:th="http://www.thymeleaf.org"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.thymeleaf.org "
>
  <head>
    <meta charset="utf-8" />
    <meta http-equiv="x-ua-compatible" content="ie=edge" />
    <title>SignUp</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="https://use.fontawesome.com/releases/v5.4.1/css/all.css"
      integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="style.css" />
  </head>
  <style>
    .form-group span {
      position: absolute;
      color: red;
      font-weight: bolder;
      font-size: 14px;
    }
    #submit-error {
      color: red;
    }
    .form-group span i{
color:green;
}

  </style>

  <body>
    <div class="container my-5">
      <h2 class="mb-5">Sign Up</h2>
      <div class="row">
        <div class="col-md-6">
          <form
            action="#"
            th:action="@{/signup}"
            th:object="${user}"
            method="post">

            <div style="color: red" th:if="${error != null}" th:text="${error}"></div>
            <div style="color: green" th:if="${info != null}" th:text="${info}"></div>
             <br>
            <div class="form">
              <div class="form-group col-md-6">
                <label for="fullName" class="col-form-label">Name</label>
                <input
                  type="text"
                  th:field="*{fullName}"
                  class="form-control"
                  id="fullName"
                  onkeyup="validateName(this.value)"
                  placeholder="Name"
                  required
                  autofocus
                />
                <span id="name-error"></span>
              </div>
              <div class="form-group col-md-6">
                <label for="username" class="col-form-label">Email</label>
                <input
                  type="text"
                  th:field="*{username}"
                  class="form-control"
                  id="username"
                  onkeyup="validateEmail(this.value)"
                  placeholder="Email"
                  required
                  autofocus
                />
                <span id="email-error"> </span>
              </div>
              <div class="form-group col-md-6">
                <label for="password" class="col-form-label">Password</label>
                <input
                  type="password"
                  th:field="*{password}"
                  class="form-control"
                  id="password"
                  onkeyup="validatePassword(this.value)"
                  placeholder="Password"
                  required
                  autofocus
                />
                <span id="password-error"></span>
              </div>
              <div class="row">
                <div class="col-md-6 mt-5">
                  <p style="text-align: center">
                    <a href="/login">Already have an account?</a>
                  </p>
                  <input
                    type="submit"
                    onclick="validateForm();"
                    class="btn btn-primary"
                    value="Submit"
                  />
                  <span id="submit-error"> </span>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div
          th:if="${success}"
          th:text="${success}"
          th:class="${'alert'+ alertClass}"
        ></div>
      </div>
    </div>
    <script>
      var nameError = document.getElementById("name-error");
      var emailError = document.getElementById("email-error");
      var passwordError = document.getElementById("password-error");
      var submitError = document.getElementById("submit-error");

      function validateName() {
        var name = document.getElementById("fullName").value;
        if (fullName.length == 0) {
          nameError.innerHTML = "Name is required";
          return false;
        }
        if (!fullName.match(/[A_za-z]*$/)) {
          nameError.innerHTML = "please Enter full name";
          return false;
        }
        nameError.innerHTML = '<i class="fas fa-check-circle"></i>';
        return true;
      }
      function validateEmail() {
        var email = document.getElementById("username").value;
        if (email.length == 0) {
          emailError.innerHTML = "Email is required";
          return false;
        }
        if (!email.match( /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/)) {
          emailError.innerHTML = "Email Invalid";
          return false;
        }
        emailError.innerHTML = '<i class="fas fa-check-circle"></i>';
        return true;
      }
      function validatePassword() {
        var password = document.getElementById("password").value;
        if (password.length == 0) {
          passwordError.innerHTML = "password is required";
          return false;
        }
        if (
          !password.match(/^(?=.{8,})(?=.*[a-z])(?=.*[A-Z])(?=.*[@#$%^&+=]).*$/)
        ) {
          passwordError.innerHTML = "Password Invalid";
          return false;
        }
        passwordError.innerHTML = '<i class="fas fa-check-circle"></i>';
        return true;
      }

      function validateForm() {
        if (!validateName() || !validateEmail() || !validatePassword()) {
          submitError.style.display = "block";
          submitError.innerHTML = "Please fix to submit";
          setTimeout(function () {
            submitError.style.display = "none";
          }, 3000);
          return false;
        }
      }
    </script>
  </body>
</html>
